{"remainingRequest":"D:\\develop_tools\\work\\maven-work\\Yansol\\msystem-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\develop_tools\\work\\maven-work\\Yansol\\msystem-web\\src\\views\\LinePurchase.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\develop_tools\\work\\maven-work\\Yansol\\msystem-web\\src\\views\\LinePurchase.vue","mtime":1683957171266},{"path":"D:\\develop_tools\\work\\maven-work\\Yansol\\msystem-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1681747155761},{"path":"D:\\develop_tools\\work\\maven-work\\Yansol\\msystem-web\\node_modules\\babel-loader\\lib\\index.js","mtime":1681747156896},{"path":"D:\\develop_tools\\work\\maven-work\\Yansol\\msystem-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1681747155761},{"path":"D:\\develop_tools\\work\\maven-work\\Yansol\\msystem-web\\node_modules\\vue-loader\\lib\\index.js","mtime":1681747158581}],"contextDependencies":[],"result":["\r\nimport {mapActions, mapGetters, mapState} from \"vuex\";\r\n\r\nexport default {\r\n  name:'LinePurchase',\r\n  data(){\r\n    return{\r\n      purchaseForm:{\r\n        tableData: [{\r\n          p_date: '',\r\n          company_name: '',\r\n          line_id: '',\r\n          line_type: '',\r\n          line_name: '',\r\n          total_count: '',\r\n          unit_price: '',\r\n        },],\r\n\r\n        rules: {\r\n          company_name: [\r\n            { required: true, message: '請選擇進貨廠商', trigger: 'change' }\r\n          ],\r\n          line_id: [\r\n            { required: true, message: '請輸入線材編號', trigger: 'blur' }\r\n          ],\r\n          line_type: [\r\n            { required: true, message: '請輸入端子', trigger: 'blur' }\r\n          ],\r\n          line_name: [\r\n            { required: true, message: '請輸入品項', trigger: 'blur' }\r\n          ],\r\n          total_count: [\r\n            { required: true, message: '請輸入進貨數量', trigger: 'blur' }\r\n          ],\r\n          unit_price: [\r\n            { required: true, message: '請輸入進貨單價', trigger: 'blur' }\r\n          ],\r\n        }\r\n      },\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapState('data',['goodData','companyData','employeeData','orderData','returnData','countData']),\r\n  },\r\n  methods: {\r\n    ...mapActions('data', ['fetchGoodData', 'fetchCompanyData', 'fetchEmployeeData', 'fetchOrderData', 'fetchReturnData']),\r\n    ...mapActions('line', ['fetchAddLineData']),\r\n    //添加一行表單\r\n    addTable () {\r\n      let newRowData = {\r\n        p_date: '',\r\n        company_name: '',\r\n        line_id: '',\r\n        line_type: '',\r\n        line_name: '',\r\n        total_count: '',\r\n        unit_price: '',\r\n      }\r\n      this.purchaseForm.tableData.push(newRowData);\r\n    },\r\n    // 提交數據\r\n    submit () {\r\n      this.$refs.purchaseForm.validate(valid => {\r\n        //驗證通過，執行if內的代碼\r\n        if(valid){\r\n          // 新增新增線材資料\r\n          this.fetchAddLineData(this.purchaseForm.tableData).then((resp) => {\r\n            this.$message.success(resp.data);\r\n          }).catch((error) => {\r\n            this.$message.error(error.response.data);\r\n          });\r\n\r\n          //清空form表單的數據\r\n          setTimeout(() => {\r\n            //重置表單數據\r\n            this.purchaseForm.tableData = [{\r\n              p_date: '',\r\n              company_name: '',\r\n              line_id: '',\r\n              line_type: '',\r\n              line_name: '',\r\n              total_count: '',\r\n              unit_price: '',\r\n            },];\r\n            this.$refs.purchaseForm.resetFields();\r\n          }, 2000);\r\n        }\r\n      })\r\n    },\r\n    //回調函數，定義表格的序號，可用來綁定資料數組\r\n    rowClassName({row, rowIndex}) {\r\n      row.id = rowIndex +1;\r\n      },\r\n    //刪除一行表格\r\n    deleteTab (data) {\r\n      //獲取當前行的數組位子\r\n      let len = data.id - 1;\r\n      //將此數組位子的資料刪除\r\n      this.purchaseForm.tableData.splice(len,1);\r\n    }\r\n  },\r\n  created() {\r\n    this.fetchCompanyData();\r\n  },\r\n}\r\n",{"version":3,"sources":["LinePurchase.vue"],"names":[],"mappings":";AAoJA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"LinePurchase.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"manage\">\r\n    <div><span class=\"title\">線材進貨</span></div>\r\n    <div class=\"manage-header\">\r\n      <el-button type=\"primary\" @click=\"addTable\">+添加欄位</el-button>\r\n    </div>\r\n    <el-form :model=\"purchaseForm\" ref=\"purchaseForm\" :rules=\"purchaseForm.rules\" inline-message>\r\n      <div class=\"common-tabel\">\r\n        <!--    人員管理表格-->\r\n        <el-table\r\n            :data=\"purchaseForm.tableData\"\r\n            :row-class-name=\"rowClassName\"\r\n            height=\"90%\"\r\n            stripe\r\n            row-key=\"viewId\"\r\n            style=\"width: 100%\">\r\n          <el-table-column label=\"序号\" align=\"center\" prop=\"id\" width=\"50\"></el-table-column>\r\n          <el-table-column\r\n              prop=\"p_date\"\r\n              label=\"進貨日\"\r\n              width=\"160\">\r\n            <template slot-scope=\"scope\">\r\n              <!-- prop的規則: 在普通的form表單中是一個對象,prop是對象的屬性. 表格是由多個對象組成的數組,在寫prop是需要根據索引給值.這里的tableData就相當於對象的屬性 !-->\r\n              <!-- rules也要單獨給 -->\r\n              <el-form-item\r\n                  :prop=\"'tableData.' + scope.$index + '.p_date'\"\r\n                  :rules='purchaseForm.rules.p_date'>\r\n                <el-date-picker\r\n                    v-model=\"purchaseForm.tableData[scope.row.id-1].p_date\"\r\n                    value-format=\"yyyy-MM-dd\"\r\n                    placeholder=\"選擇日期\">\r\n                </el-date-picker>\r\n              </el-form-item>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column\r\n              prop= \"company_name\"\r\n              label=\"進貨廠商\"\r\n              width=\"180\">\r\n            <template slot-scope=\"scope\">\r\n              <el-form-item\r\n                  :prop=\"'tableData.' + scope.$index + '.company_name'\"\r\n                  :rules='purchaseForm.rules.company_name'>\r\n                <el-select v-model=\"purchaseForm.tableData[scope.row.id-1].company_name\" placeholder=\"請選擇\">\r\n                  <el-option\r\n                      v-for=\"item in companyData\"\r\n                      :key=\"item.companyId\"\r\n                      :label=\"item.companyName\"\r\n                      :value=\"item.companyId\">\r\n                  </el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column\r\n              prop=\"line_id\"\r\n              label=\"線材編號\"\r\n              width=\"150\">\r\n            <template slot-scope=\"scope\">\r\n              <el-form-item\r\n                  :prop=\"'tableData.' + scope.$index + '.line_id'\"\r\n                  :rules='purchaseForm.rules.line_id'>\r\n                <el-input v-model=\"purchaseForm.tableData[scope.row.id-1].line_id\"\r\n                          oninput=\"value=value.replace(/[^\\d]/g,'')\"\r\n                          placeholder=\"請輸入線材編號\">\r\n\r\n                </el-input>\r\n              </el-form-item>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column\r\n              prop=\"line_type\"\r\n              label=\"端子\"\r\n              width=\"340\">\r\n            <template slot-scope=\"scope\">\r\n              <el-form-item\r\n                  :prop=\"'tableData.' + scope.$index + '.line_type'\"\r\n                  :rules='purchaseForm.rules.line_type'>\r\n                <el-input v-model=\"purchaseForm.tableData[scope.row.id-1].line_type\"\r\n                          placeholder=\"請輸入端子\">\r\n\r\n                </el-input>\r\n              </el-form-item>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column\r\n              prop=\"line_name\"\r\n              label=\"品項\"\r\n              width=\"340\">\r\n            <template slot-scope=\"scope\">\r\n              <el-form-item\r\n                  :prop=\"'tableData.' + scope.$index + '.line_name'\"\r\n                  :rules='purchaseForm.rules.line_name'>\r\n                <el-input v-model=\"purchaseForm.tableData[scope.row.id-1].line_name\"\r\n                          placeholder=\"請輸入品項\">\r\n\r\n                </el-input>\r\n              </el-form-item>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column\r\n              prop=\"total_count\"\r\n              label=\"進貨數量\"\r\n              width=\"150\">\r\n            <template slot-scope=\"scope\">\r\n              <el-form-item\r\n                  :prop=\"'tableData.' + scope.$index + '.total_count'\"\r\n                  :rules='purchaseForm.rules.total_count'>\r\n                <el-input v-model=\"purchaseForm.tableData[scope.row.id-1].total_count\"\r\n                          oninput=\"value=value.replace(/[^\\d]/g,'')\"\r\n                          placeholder=\"請輸入數量\">\r\n\r\n                </el-input>\r\n              </el-form-item>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column\r\n              prop=\"unit_price\"\r\n              label=\"進貨單價\"\r\n              width=\"150\">\r\n            <template slot-scope=\"scope\">\r\n              <el-form-item\r\n                  :prop=\"'tableData.' + scope.$index + '.unit_price'\"\r\n                  :rules='purchaseForm.rules.unit_price'>\r\n                <el-input v-model=\"purchaseForm.tableData[scope.row.id-1].unit_price\"\r\n                          oninput=\"value=value.replace(/[^\\d]/g,'')\"\r\n                          placeholder=\"請輸入單價\">\r\n\r\n                </el-input>\r\n              </el-form-item>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column\r\n              prop=\"addr\"\r\n              label=\"操作\"\r\n              width=\"120\">\r\n            <template slot-scope=\"scope\">\r\n              <el-button type=\"danger\" size=\"mini\" @click=\"deleteTab(scope.row)\">刪除</el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n        <el-button type=\"primary\" :plain=\"true\" class=\"submit_btn\" @click=\"submit\">提交</el-button>\r\n      </div>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {mapActions, mapGetters, mapState} from \"vuex\";\r\n\r\nexport default {\r\n  name:'LinePurchase',\r\n  data(){\r\n    return{\r\n      purchaseForm:{\r\n        tableData: [{\r\n          p_date: '',\r\n          company_name: '',\r\n          line_id: '',\r\n          line_type: '',\r\n          line_name: '',\r\n          total_count: '',\r\n          unit_price: '',\r\n        },],\r\n\r\n        rules: {\r\n          company_name: [\r\n            { required: true, message: '請選擇進貨廠商', trigger: 'change' }\r\n          ],\r\n          line_id: [\r\n            { required: true, message: '請輸入線材編號', trigger: 'blur' }\r\n          ],\r\n          line_type: [\r\n            { required: true, message: '請輸入端子', trigger: 'blur' }\r\n          ],\r\n          line_name: [\r\n            { required: true, message: '請輸入品項', trigger: 'blur' }\r\n          ],\r\n          total_count: [\r\n            { required: true, message: '請輸入進貨數量', trigger: 'blur' }\r\n          ],\r\n          unit_price: [\r\n            { required: true, message: '請輸入進貨單價', trigger: 'blur' }\r\n          ],\r\n        }\r\n      },\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapState('data',['goodData','companyData','employeeData','orderData','returnData','countData']),\r\n  },\r\n  methods: {\r\n    ...mapActions('data', ['fetchGoodData', 'fetchCompanyData', 'fetchEmployeeData', 'fetchOrderData', 'fetchReturnData']),\r\n    ...mapActions('line', ['fetchAddLineData']),\r\n    //添加一行表單\r\n    addTable () {\r\n      let newRowData = {\r\n        p_date: '',\r\n        company_name: '',\r\n        line_id: '',\r\n        line_type: '',\r\n        line_name: '',\r\n        total_count: '',\r\n        unit_price: '',\r\n      }\r\n      this.purchaseForm.tableData.push(newRowData);\r\n    },\r\n    // 提交數據\r\n    submit () {\r\n      this.$refs.purchaseForm.validate(valid => {\r\n        //驗證通過，執行if內的代碼\r\n        if(valid){\r\n          // 新增新增線材資料\r\n          this.fetchAddLineData(this.purchaseForm.tableData).then((resp) => {\r\n            this.$message.success(resp.data);\r\n          }).catch((error) => {\r\n            this.$message.error(error.response.data);\r\n          });\r\n\r\n          //清空form表單的數據\r\n          setTimeout(() => {\r\n            //重置表單數據\r\n            this.purchaseForm.tableData = [{\r\n              p_date: '',\r\n              company_name: '',\r\n              line_id: '',\r\n              line_type: '',\r\n              line_name: '',\r\n              total_count: '',\r\n              unit_price: '',\r\n            },];\r\n            this.$refs.purchaseForm.resetFields();\r\n          }, 2000);\r\n        }\r\n      })\r\n    },\r\n    //回調函數，定義表格的序號，可用來綁定資料數組\r\n    rowClassName({row, rowIndex}) {\r\n      row.id = rowIndex +1;\r\n      },\r\n    //刪除一行表格\r\n    deleteTab (data) {\r\n      //獲取當前行的數組位子\r\n      let len = data.id - 1;\r\n      //將此數組位子的資料刪除\r\n      this.purchaseForm.tableData.splice(len,1);\r\n    }\r\n  },\r\n  created() {\r\n    this.fetchCompanyData();\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.title{\r\n  font-size: 24px;\r\n  font-weight: bold;\r\n  border-bottom: 1px solid black;\r\n}\r\n/* 日期选择框的宽度 */\r\n.el-date-editor.el-input, .el-date-editor.el-input__inner {\r\n  width: 140px;\r\n}\r\n.el-form-item {\r\n  margin-bottom: auto;\r\n}\r\n\r\n.manage {\r\n  height: 100%;\r\n}\r\n\r\n.manage .manage-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n.manage .common-tabel {\r\n  position: relative;\r\n  height: 80vh;\r\n  /*height: 700px;*/\r\n}\r\n\r\n.manage .common-tabel .pager {\r\n  position: absolute;\r\n  bottom: 40px;\r\n  right: 20px;\r\n}\r\n.submit_btn{\r\n  margin-left: 1400px;\r\n  margin-top: 20px;\r\n}\r\n.manage .common-tabel .pager {\r\n  position: absolute;\r\n  bottom: 40px;\r\n  right: 20px;\r\n}\r\n\r\n</style>"]}]}